{-# LANGUAGE QuasiQuotes #-}

module Main where

import Formula.Parser
import Formula.Simplifier
import Data.Text.Prettyprint.Doc

main :: IO ()
main = do 
    let e = [pexpr|((a1 = a2) && ((a6 = a7) && ((a4 = 0) && ((a3 = 0) && (a5 = 0))))) || (((not (a4 = 1)) && ((a0 <= 1) && ((1 <= a0) && ((a5 = 0) && (a3 = 0))))) || (((a1 = a2) && ((not (a6 = a7)) && ((a3 = 0) && ((a4 = 0) && ((a5 = 1) && (a0 = 0)))))) || (((a4 = 1) && ((a0 <= 1) && ((1 <= a0) && ((not (a5 = 1)) && (((a1 <= -1) || (not (a2 = 0))) && ((a5 = 0) && ((a6 = a7) && (not (a3 = 1))))))))) || (((not (a0 = a4)) && ((a0 = 0) && ((1 <= (a4 + (-1 * a5))) && ((a1 = a2) && (a5 = 1))))) || (((a1 = a2) && ((a5 = 1) && ((a0 = 0) && ((a3 = 1) && (not (a4 = -1)))))) || (((not (a0 = a4)) && ((a3 = 0) && ((a4 = 0) && ((not (a0 = 1)) && (a5 = 1))))) || (((a5 = 1) && ((a3 = -1) && ((not (((-1 * a1) + a2) <= 0)) && ((0 <= ((-1 * a0) + a4)) && ((not (a4 = 1)) && (a0 = 2)))))) || (((not (a0 = a4)) && ((not (a3 = -1)) && ((1 <= ((-1 * a1) + a2)) && ((-1 <= (a1 + (-1 * a2))) && (((not ((a1 + (-1 * a6)) <= 1)) || ((a2 = a7) || (not (((-1 * a1) + a6) <= -1)))) && ((a4 = 0) && ((a3 = 1) && (a5 = 1)))))))) || (((a0 = 0) && ((a1 = a2) && ((not (a5 = 0)) && ((not (a4 = a5)) && ((not (a4 = 1)) && ((a3 = 1) && (not (a5 = 1)))))))) || (((a3 = -1) && ((not (a5 = 1)) && ((not (a4 = 1)) && ((not (a0 = -1)) && ((not (a0 = 0)) && ((a0 <= 2) && ((not (a4 = 0)) && (0 <= ((-1 * a0) + a4))))))))) || (((a5 = 0) && ((not (a4 = 1)) && ((not (a3 = 0)) && ((a4 = 0) && ((a0 = 0) && ((((-2 + a7) = a2) || (not (a1 = a6))) && (a3 = 2))))))) || (((not (a5 = 1)) && ((2 <= (a2 + (-1 * a1))) && ((0 <= (a4 + (-1 * a0))) && ((not (a3 = 0)) && (((-2 + a7) = a6) && (((a2 = a7) || ((not ((a7 + (-1 * a1)) <= 2)) || (not (((-1 * a7) + a1) <= -2)))) && ((not (a0 = 0)) && (a3 <= -1)))))))) || (((a5 = 1) && ((not (a0 = 1)) && ((not (a3 = 0)) && ((a3 <= -2) && ((-2 <= a3) && ((not (a4 = 1)) && ((a0 <= 2) && ((not (a1 = a2)) && (a0 = a4))))))))) || (((a5 = 1) && (((not (a3 <= -2)) || (not (a3 >= -2))) && (((not ((a3 + (-1 * a0)) <= 0)) || ((a3 = 1) || (not (((-1 * a3) + a0) <= 0)))) && (((not (a3 <= 1)) || (not (a3 >= 1))) && ((not (a4 = 1)) && ((a0 <= 1) && ((-2 <= ((-1 * a1) + (a2 + (a6 + (-1 * a7))))) && ((2 <= (a1 + ((-1 * a2) + ((-1 * a6) + a7)))) && (not (a4 = 0)))))))))) || (((not (a4 = 1)) && ((a3 = 0) && ((a4 = 0) && ((-2 <= ((-1 * a7) + a6)) && ((not (a0 = 0)) && (((a7 + ((-1 * a6) + a1)) = a2) && (a0 = a5))))))) || (((2 <= (a2 + (-1 * a1))) && ((-2 <= ((-1 * a2) + a1)) && (((not (((-1 * a2) + a6) <= -4)) || ((a2 = a7) || (not ((a2 + (-1 * a6)) <= 4)))) && ((0 <= (a5 + (-1 * a0))) && ((not (a3 = 1)) && ((a4 = 0) && ((not (a0 = 0)) && ((not (a3 = 0)) && ((not (a5 = 1)) && (not (a0 <= 0))))))))))) || (((not (a0 = 0)) && ((a5 = 1) && ((not (a4 = 1)) && ((a4 = 0) && (((not (a0 <= 1)) || (not (a0 >= 1))) && ((not (a0 >= 3)) && ((2 + a1) = a2))))))) || (((a3 = 1) && ((not (a0 = 1)) && ((2 <= (a2 + (-1 * a1))) && ((-2 <= ((-1 * a2) + a1)) && ((a4 = 0) && ((not (a5 = 0)) && (a0 <= 2))))))) || (((not (a5 = 1)) && ((a0 <= 1) && ((a0 >= 1) && ((not (a4 = 0)) && ((1 <= ((-1 * a1) + a2)) && ((1 <= a5) && ((-1 <= ((-1 * a2) + a1)) && (not (a4 = 1))))))))) || (((a4 = 1) && ((-2 <= (a1 + (-1 * a2))) && ((2 <= (a2 + (-1 * a1))) && (((a2 = a7) || ((not (((-1 * a2) + a6) <= -4)) || (not ((a2 + (-1 * a6)) <= 4)))) && ((0 <= (a5 + (-1 * a0))) && ((not (a5 = 1)) && ((2 <= a0) && ((a0 <= 2) && (((a2 + (-1 * a1)) = a5) && (4 <= (a7 + (-1 * a6)))))))))))) || (((-2 <= (a6 + (-1 * a7))) && ((0 <= ((-1 * a0) + a5)) && ((a4 = 1) && ((not (a5 = 1)) && ((2 <= (a7 + (-1 * a6))) && (((3 <= a2) || (not (a1 = 1))) && ((a0 <= 2) && (not (a0 = 0))))))))) || (((0 <= ((-1 * a0) + a5)) && ((not (a5 = 1)) && ((not (a3 = 1)) && ((a0 <= 2) && (((3 <= a2) || (not (a1 = 1))) && ((a4 = 1) && ((not (a0 = 0)) && ((2 <= (a2 + (-1 * a1))) && ((-2 <= ((-1 * a2) + a1)) && (a0 = 2)))))))))) || (((a0 = 0) && ((a5 = 1) && ((a1 = a2) && (((2 + a6) = a7) && ((not (a4 = 0)) && (a4 = 1)))))) || (((not (a3 = 0)) && ((a5 = 1) && (((not (a0 <= 1)) || (not (a0 >= 1))) && ((a4 = 1) && ((1 <= a3) && ((2 <= ((-1 * a1) + a2)) && ((a0 <= 2) && ((-2 <= ((-1 * a2) + a1)) && (-3 <= (a6 + (-1 * a7))))))))))) || (((not (a5 = 1)) && ((not (a4 = 1)) && ((a0 = 0) && ((not (a4 = 0)) && ((a1 = a2) && (0 <= a4)))))) || (((a3 = 0) && (((not (a0 <= 1)) || (not (a0 >= 1))) && ((not (a0 = 0)) && ((a4 = 1) && (a5 = 1))))) || ((((a1 + (-1 * a2)) <= -2) && ((a4 = 1) && ((a5 = 1) && ((not (a3 >= 1)) && ((a0 >= 1) && (2 <= a0)))))) || (((a4 = 1) && ((a0 <= 1) && ((a0 >= 1) && ((not (a3 = 1)) && ((1 <= (a2 + (-1 * a1))) && (-1 <= ((-1 * a2) + a1))))))) || (((a5 = 1) && ((a0 = 0) && ((not (a3 = 0)) && ((a3 <= -1) && ((not (a4 = 0)) && (a4 = 1)))))) || (((not (a3 <= 0)) && ((a4 = 1) && ((not (a5 = 0)) && ((a0 = 1) && ((3 <= (a7 + (-1 * a6))) && ((((2 + a2) = a7) || (not (a1 = a6))) && ((a5 = 1) && ((2 <= a2) || (not (a1 = 1)))))))))) || (((not (a0 = 0)) && ((a5 = 1) && ((2 <= a4) && ((1 <= ((-1 * a1) + a2)) && ((a0 <= 1) && (not (a3 = 0))))))) || (((a5 = 0) && ((not (a0 = 0)) && ((not (a4 = 0)) && ((a4 = 1) && (((not (a0 <= 1)) || (not (a0 >= 1))) && ((a6 = a7) && ((a0 >= 1) && ((not (a0 = a3)) && (a0 <= 2))))))))) || (((a0 = 1) && ((a4 = a5) && (((a2 + (-1 * a1)) >= 2) && (not (a4 <= 1))))) || (((a0 <= 2) && ((not ((a7 + (-1 * a6)) <= 2)) && ((0 <= ((-1 * a0) + a4)) && ((not (a5 = 1)) && ((not (a4 = 1)) && ((2 <= (a2 + (-1 * a1))) && ((-2 <= ((-1 * a2) + a1)) && (((not (((-1 * a2) + a6) <= -4)) || ((a2 = a7) || (not ((a2 + (-1 * a6)) <= 4)))) && ((not (a3 = 1)) && ((not (a3 = -1)) && ((a3 <= 0) && ((not (a0 = 0)) && ((a0 <= 1) || (not (a5 = 0))))))))))))))) || (((a0 = 0) && ((not (a5 = 0)) && ((not (a4 = 0)) && ((a1 = a2) && ((a4 = 1) && ((not (a3 = 0)) && (not (a5 = 1)))))))) || (((a5 = 0) && ((not (a4 = 0)) && ((a4 = 1) && ((a3 <= 0) && ((a0 = 0) && (not (a3 = 0))))))) || (((a5 = 0) && ((not (a0 = 0)) && ((not (a4 = 0)) && ((a0 <= 2) && (((a1 <= -2) || (not (a2 = 0))) && ((2 <= a0) && (((a2 = a7) || (not (a1 = a6))) && ((a3 <= 0) && (not (a4 = 1)))))))))) || (((a4 = 1) && ((a0 = 0) && ((1 <= a3) && ((a1 = a2) && ((a3 <= 1) && ((not (a5 = 1)) && ((-2 <= (a6 + (-1 * a7))) || (not (a1 = a6))))))))) || (((not (a0 = 0)) && ((not (a4 = 0)) && ((a0 <= 2) && ((a5 = 0) && ((1 <= ((-1 * a1) + a2)) && ((a0 <= 1) && ((a3 <= 1) && (not (a4 = 1))))))))) || (((a4 = 1) && ((a1 = a2) && ((a3 = 0) && ((a0 = 0) && ((a5 = 0) && ((((-1 + a7) = a2) || (not (a1 = a6))) && (-1 <= ((-1 * a7) + a6)))))))) || (((not (a3 = 0)) && ((not (a0 = 1)) && ((not (a0 = a3)) && ((a4 = 1) && ((a0 = 0) && (2 <= a3)))))) || (((not (a0 = 0)) && ((not (a0 = a5)) && ((a6 = a7) && ((a5 = 0) && ((not (a4 = 0)) && ((not (a4 = 1)) && ((2 <= a0) && ((a3 = -2) && (a0 <= 2))))))))) || (((not (a4 = a5)) && ((not (a0 = 0)) && ((a5 = 0) && ((a0 = 2) && ((not (a3 = 2)) && ((not (a4 = 2)) && ((not (a6 = a7)) && ((-2 + a2) = a1)))))))) || (((a3 <= 0) && ((not (a4 = 1)) && ((a3 >= 0) && ((2 <= a0) && ((a5 = 1) && ((not (a3 <= -2)) && ((a0 <= 2) && ((-2 + a2) = a1)))))))) || (((not (a5 = 0)) && ((not (a3 = 0)) && ((a0 = 0) && ((a4 = 0) && ((not (a5 = 1)) && ((a1 = a2) && ((2 <= a5) && (not (a3 = 1))))))))) || (((-2 <= ((-1 * a7) + a6)) && ((a3 = 0) && ((a1 = a2) && ((a0 = 0) && ((a4 = 0) && ((not (a5 = 1)) && (not (a5 = 0)))))))) || (((not (a0 = 0)) && ((3 <= a5) && ((a4 = 1) && (a0 <= 1)))) || (((a1 = a2) && ((a0 = 0) && ((not (a5 = 1)) && ((not (a5 = 0)) && ((not (a4 = 0)) && ((a4 = 1) && ((2 <= a5) && ((-3 <= ((-1 * a7) + a6)) && (3 <= ((-1 * a6) + a7)))))))))) || (((not (a4 = 0)) && ((1 <= ((-1 * a1) + a2)) && ((a4 = 1) && ((a5 = 0) && ((a0 <= 1) && ((not (a0 = 0)) && ((a0 = 1) && ((-2 <= (a6 + (-1 * a7))) && (2 <= ((-1 * a6) + a7)))))))))) || (((not (a4 = 0)) && ((1 <= (a2 + (-1 * a1))) && ((a4 = 1) && ((not (a5 = 0)) && ((not (a0 >= 2)) && ((not (a3 = 0)) && ((1 <= a0) && (4 <= ((-1 * a6) + a7))))))))) || (((a0 = 0) && (((not (a2 = 0)) || (not (a1 = 1))) && ((a4 = 1) && ((not (a5 = 0)) && (3 <= a5))))) || (((a0 = 0) && ((not (a3 = 0)) && ((a4 = 0) && ((a1 = a2) && ((not (a5 = 0)) && (a3 = 2)))))) || (((not (a4 = 0)) && ((a3 = 0) && ((not (a0 = 0)) && ((not (a5 = 0)) && ((a5 = 1) && ((a0 <= 1) && ((not (a4 = 1)) && (not (a4 = 2))))))))) || (((not (a0 = 0)) && ((a4 = 0) && ((a0 >= 1) && ((a0 <= 1) && ((not (a5 = 1)) && ((2 <= a5) && ((not (a3 = 1)) && (not (a3 = 0))))))))) || (((a5 = 1) && ((a0 <= 1) && ((not (a3 <= 1)) && (3 <= a3)))) || (((a0 <= 1) && ((not (a5 <= 1)) && ((a4 = 0) && ((a3 = 1) && (((not ((a6 + (-1 * a1)) <= -2)) || ((a2 = a7) || (not ((a1 + (-1 * a6)) <= 2)))) && ((a5 <= 2) && ((a2 = 1) || ((not (a1 <= 0)) || (not (a1 >= 0)))))))))) || (((not (a3 = 1)) && ((not (a5 = 1)) && ((a4 = 0) && ((a3 = 0) && ((not (a5 <= 1)) && (a0 = 1)))))) || (((a0 = 0) && ((not (a5 = 0)) && ((a4 = 0) && ((not (a5 = 1)) && ((3 <= a5) && (a1 = a2)))))) || (((not (a3 = 0)) && ((a4 = 0) && ((3 <= a5) && ((4 <= ((-1 * a6) + a7)) && (((a2 = 1) || ((not (a1 <= 0)) || (not (a1 >= 0)))) && (((not (a0 <= 2)) || (not (a0 >= 2))) && ((a3 = 1) && (not (a0 >= 3))))))))) || (((not (a0 = 0)) && ((not (a0 = a5)) && ((not (a5 = 1)) && ((a5 = 0) && ((a4 = 0) && (((not (a0 <= 1)) || (not (a0 >= 1))) && (a3 = 0))))))) || (((a4 = 0) && ((not (a0 = 0)) && ((a5 = 1) && ((not (a3 <= 1)) && ((not (a3 <= -2)) && (((a2 + (-1 * a1)) >= 1) && (((a2 + (-1 * a1)) <= 1) && ((-2 <= (a6 + (a2 + ((-1 * a1) + (-1 * a7))))) && ((not ((a3 + (-1 * a0)) <= 0)) && ((not ((a6 + (-1 * a7)) >= -2)) && (a0 <= 1))))))))))) || (((a0 = 0) && ((a1 = a2) && ((not (a4 = 1)) && ((a4 = 0) && (a3 = 1))))) || (((a0 = 0) && ((not (a3 = 0)) && ((0 <= a3) && (3 <= a3)))) || (((a0 <= 1) && ((not (a3 <= 1)) && ((3 <= a3) && ((not (a0 = 0)) && ((not (a3 >= 4)) && (a0 = 1)))))) || (((not (a0 >= 3)) && ((not (a0 = 0)) && ((a0 <= 1) && ((-1 <= (a1 + (-1 * a2))) && ((1 <= ((-1 * a1) + a2)) && ((1 <= a0) && ((not (a4 = 1)) && ((not (a4 = -1)) && ((not (a5 = 1)) && ((a3 <= 1) && ((a5 = 0) && ((a2 = a7) || (not (a1 = a6)))))))))))))) || (((a5 = 0) && ((a4 = 0) && ((not (a0 = 0)) && (((not (a0 <= 1)) || (not (a0 >= 1))) && (((not (a0 <= 3)) || (not (a0 >= 3))) && (a3 <= 1)))))) || (((a3 <= 2) && ((not (a3 <= 1)) && ((not (a0 = 0)) && ((a5 = 0) && ((a4 = 0) && (not (a0 = a3))))))) || ((a3 = 2) && ((not (a0 = 0)) && ((a5 = 0) && ((a4 = 0) && ((-2 + a2) = a1))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))|]
    print $ pretty e
    putStrLn "\nSimplified to:\n"
    print $ pretty $ simplifyExpr e
